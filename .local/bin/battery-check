#!/bin/sh
PERCENT=$(upower -i /org/freedesktop/UPower/devices/DisplayDevice \
    | awk '/percentage:/ {gsub("%",""); print int($2)}')
STATE=$(upower -i /org/freedesktop/UPower/devices/DisplayDevice \
    | awk -F: '/state/ {gsub(/^[ \t]+/, "", $2); print $2}')

if [ $PERCENT -lt 20 ] && [ $STATE != "charging" ]; then
    notify-send -u critical "Battery Low" "Battery at ${PERCENT}%. Plug in your charger!"
fi
